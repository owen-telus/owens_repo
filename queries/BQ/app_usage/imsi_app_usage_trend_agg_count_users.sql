SELECT 
  ts_index,
  start_dt, 
  end_dt,
  COUNT(DISTINCT IF(usage_volume_MB_entertainment_sports > 0, imsi_num, NULL)) AS num_entertainment_sports_users,
  COUNT(DISTINCT IF(usage_volume_MB_realestate_landlord > 0, imsi_num, NULL)) AS num_realestate_landlord_users,
  COUNT(DISTINCT IF(usage_volume_MB_agriculture_farmmanagement > 0, imsi_num, NULL)) AS num_agriculture_farmmanagement_users,
  COUNT(DISTINCT IF(usage_volume_MB_productivity_education > 0, imsi_num, NULL)) AS num_productivity_education_users,
  COUNT(DISTINCT IF(usage_volume_MB_telecom_telus > 0, imsi_num, NULL)) AS num_telecom_telus_users,
  COUNT(DISTINCT IF(usage_volume_MB_realestate_buysellrent > 0, imsi_num, NULL)) AS num_realestate_buysellrent_users,
  COUNT(DISTINCT IF(usage_volume_MB_travel_trips > 0, imsi_num, NULL)) AS num_travel_trips_users,
  COUNT(DISTINCT IF(usage_volume_MB_finance_banking > 0, imsi_num, NULL)) AS num_finance_banking_users,
  COUNT(DISTINCT IF(usage_volume_MB_pets_dogs > 0, imsi_num, NULL)) AS num_pets_dogs_users,
  COUNT(DISTINCT IF(usage_volume_MB_lifestyle_mentalhealth > 0, imsi_num, NULL)) AS num_lifestyle_mentalhealth_users,
  COUNT(DISTINCT IF(usage_volume_MB_os_appstore > 0, imsi_num, NULL)) AS num_os_appstore_users,
  COUNT(DISTINCT IF(usage_volume_MB_news_generic > 0, imsi_num, NULL)) AS num_news_generic_users,
  COUNT(DISTINCT IF(usage_volume_MB_entertainment_music > 0, imsi_num, NULL)) AS num_entertainment_music_users,
  COUNT(DISTINCT IF(usage_volume_MB_communication_miscellaneous > 0, imsi_num, NULL)) AS num_communication_miscellaneous_users,
  COUNT(DISTINCT IF(usage_volume_MB_gaming_moderate > 0, imsi_num, NULL)) AS num_gaming_moderate_users,
  COUNT(DISTINCT IF(usage_volume_MB_utility_security > 0, imsi_num, NULL)) AS num_utility_security_users,
  COUNT(DISTINCT IF(usage_volume_MB_communication_socialmedia > 0, imsi_num, NULL)) AS num_communication_socialmedia_users,
  COUNT(DISTINCT IF(usage_volume_MB_productivity_other > 0, imsi_num, NULL)) AS num_productivity_other_users,
  COUNT(DISTINCT IF(usage_volume_MB_shopping_fashion > 0, imsi_num, NULL)) AS num_shopping_fashion_users,
  COUNT(DISTINCT IF(usage_volume_MB_productivity_webbrowser > 0, imsi_num, NULL)) AS num_productivity_webbrowser_users,
  COUNT(DISTINCT IF(usage_volume_MB_finance_utilities > 0, imsi_num, NULL)) AS num_finance_utilities_users,
  COUNT(DISTINCT IF(usage_volume_MB_travel_travel > 0, imsi_num, NULL)) AS num_travel_travel_users,
  COUNT(DISTINCT IF(usage_volume_MB_lifestyle_fitness > 0, imsi_num, NULL)) AS num_lifestyle_fitness_users,
  COUNT(DISTINCT IF(usage_volume_MB_finance_business > 0, imsi_num, NULL)) AS num_finance_business_users,
  COUNT(DISTINCT IF(usage_volume_MB_lifestyle_relationships > 0, imsi_num, NULL)) AS num_lifestyle_relationships_users,
  COUNT(DISTINCT IF(usage_volume_MB_telecom_wireline > 0, imsi_num, NULL)) AS num_telecom_wireline_users,
  COUNT(DISTINCT IF(usage_volume_MB_travel_lodging > 0, imsi_num, NULL)) AS num_travel_lodging_users,
  COUNT(DISTINCT IF(usage_volume_MB_productivity_editingsoftware > 0, imsi_num, NULL)) AS num_productivity_editingsoftware_users,
  COUNT(DISTINCT IF(usage_volume_MB_pets_petssupplies > 0, imsi_num, NULL)) AS num_pets_petssupplies_users,
  COUNT(DISTINCT IF(usage_volume_MB_travel_ridehailing > 0, imsi_num, NULL)) AS num_travel_ridehailing_users,
  COUNT(DISTINCT IF(usage_volume_MB_agriculture_farmassociations > 0, imsi_num, NULL)) AS num_agriculture_farmassociations_users,
  COUNT(DISTINCT IF(usage_volume_MB_productivity_professional > 0, imsi_num, NULL)) AS num_productivity_professional_users,
  COUNT(DISTINCT IF(usage_volume_MB_smarthome_automation > 0, imsi_num, NULL)) AS num_smarthome_automation_users,
  COUNT(DISTINCT IF(usage_volume_MB_lifestyle_healthcare > 0, imsi_num, NULL)) AS num_lifestyle_healthcare_users,
  COUNT(DISTINCT IF(usage_volume_MB_entertainment_tvandmovies > 0, imsi_num, NULL)) AS num_entertainment_tvandmovies_users,
  COUNT(DISTINCT IF(usage_volume_MB_travel_flights > 0, imsi_num, NULL)) AS num_travel_flights_users,
  COUNT(DISTINCT IF(usage_volume_MB_gaming_casual > 0, imsi_num, NULL)) AS num_gaming_casual_users,
  COUNT(DISTINCT IF(usage_volume_MB_finance_paymentapps > 0, imsi_num, NULL)) AS num_finance_paymentapps_users,
  COUNT(DISTINCT IF(usage_volume_MB_gaming_kids > 0, imsi_num, NULL)) AS num_gaming_kids_users,
  COUNT(DISTINCT IF(usage_volume_MB_travel_navigation > 0, imsi_num, NULL)) AS num_travel_navigation_users,
  COUNT(DISTINCT IF(usage_volume_MB_utility_devicecare > 0, imsi_num, NULL)) AS num_utility_devicecare_users,
  COUNT(DISTINCT IF(usage_volume_MB_telecom_wirelesswireline > 0, imsi_num, NULL)) AS num_telecom_wirelesswireline_users,
  COUNT(DISTINCT IF(usage_volume_MB_entertainment_news > 0, imsi_num, NULL)) AS num_entertainment_news_users,
  COUNT(DISTINCT IF(usage_volume_MB_telecom_others > 0, imsi_num, NULL)) AS num_telecom_others_users,
  COUNT(DISTINCT IF(usage_volume_MB_news_weather > 0, imsi_num, NULL)) AS num_news_weather_users,
  COUNT(DISTINCT IF(usage_volume_MB_entertainment_radio > 0, imsi_num, NULL)) AS num_entertainment_radio_users,
  COUNT(DISTINCT IF(usage_volume_MB_travel_airport > 0, imsi_num, NULL)) AS num_travel_airport_users,
  COUNT(DISTINCT IF(usage_volume_MB_entertainment_live > 0, imsi_num, NULL)) AS num_entertainment_live_users,
  COUNT(DISTINCT IF(usage_volume_MB_telecom_pricecomparison > 0, imsi_num, NULL)) AS num_telecom_pricecomparison_users,
  COUNT(DISTINCT IF(usage_volume_MB_pets_other > 0, imsi_num, NULL)) AS num_pets_other_users,
  COUNT(DISTINCT IF(usage_volume_MB_lifestyle_identification > 0, imsi_num, NULL)) AS num_lifestyle_identification_users,
  COUNT(DISTINCT IF(usage_volume_MB_realestate_projectmanagement > 0, imsi_num, NULL)) AS num_realestate_projectmanagement_users,
  COUNT(DISTINCT IF(usage_volume_MB_communication_talking > 0, imsi_num, NULL)) AS num_communication_talking_users,
  COUNT(DISTINCT IF(usage_volume_MB_network_security > 0, imsi_num, NULL)) AS num_network_security_users,
  COUNT(DISTINCT IF(usage_volume_MB_realestate_moving > 0, imsi_num, NULL)) AS num_realestate_moving_users,
  COUNT(DISTINCT IF(usage_volume_MB_productivity_email > 0, imsi_num, NULL)) AS num_productivity_email_users,
  COUNT(DISTINCT IF(usage_volume_MB_telecom_wireless > 0, imsi_num, NULL)) AS num_telecom_wireless_users,
  COUNT(DISTINCT IF(usage_volume_MB_travel_fleetmanagement > 0, imsi_num, NULL)) AS num_travel_fleetmanagement_users,
  COUNT(DISTINCT IF(usage_volume_MB_communication_messaging > 0, imsi_num, NULL)) AS num_communication_messaging_users,
  COUNT(DISTINCT IF(usage_volume_MB_gaming_cloud > 0, imsi_num, NULL)) AS num_gaming_cloud_users,
  COUNT(DISTINCT IF(usage_volume_MB_os_other > 0, imsi_num, NULL)) AS num_os_other_users,
  COUNT(DISTINCT IF(usage_volume_MB_entertainment_reading > 0, imsi_num, NULL)) AS num_entertainment_reading_users,
  COUNT(DISTINCT IF(usage_volume_MB_finance_moneytransfer > 0, imsi_num, NULL)) AS num_finance_moneytransfer_users,
  COUNT(DISTINCT IF(usage_volume_MB_telecom_wirelesswirelinesmarthome > 0, imsi_num, NULL)) AS num_telecom_wirelesswirelinesmarthome_users,
  COUNT(DISTINCT IF(usage_volume_MB_news_politics > 0, imsi_num, NULL)) AS num_news_politics_users,
  COUNT(DISTINCT IF(usage_volume_MB_telecom_smarthome > 0, imsi_num, NULL)) AS num_telecom_smarthome_users,
  COUNT(DISTINCT IF(usage_volume_MB_productivity_softwaredevelopment > 0, imsi_num, NULL)) AS num_productivity_softwaredevelopment_users,
  COUNT(DISTINCT IF(usage_volume_MB_lifestyle_kids > 0, imsi_num, NULL)) AS num_lifestyle_kids_users,
  COUNT(DISTINCT IF(usage_volume_MB_telecom_benchmark > 0, imsi_num, NULL)) AS num_telecom_benchmark_users,
  COUNT(DISTINCT IF(usage_volume_MB_os_update > 0, imsi_num, NULL)) AS num_os_update_users,
  COUNT(DISTINCT IF(usage_volume_MB_communication_calling > 0, imsi_num, NULL)) AS num_communication_calling_users,
  COUNT(DISTINCT IF(usage_volume_MB_entertainment_miscellaneous > 0, imsi_num, NULL)) AS num_entertainment_miscellaneous_users,
  COUNT(DISTINCT IF(usage_volume_MB_network_protocol > 0, imsi_num, NULL)) AS num_network_protocol_users,
  COUNT(DISTINCT IF(usage_volume_MB_smarthome_security > 0, imsi_num, NULL)) AS num_smarthome_security_users,
  COUNT(DISTINCT IF(usage_volume_MB_pets_cats > 0, imsi_num, NULL)) AS num_pets_cats_users,
  COUNT(DISTINCT IF(usage_volume_MB_news_finance > 0, imsi_num, NULL)) AS num_news_finance_users,
  COUNT(DISTINCT IF(usage_volume_MB_productivity_filetransfer > 0, imsi_num, NULL)) AS num_productivity_filetransfer_users,
  COUNT(DISTINCT IF(usage_volume_MB_entertainment_kids > 0, imsi_num, NULL)) AS num_entertainment_kids_users,
  COUNT(DISTINCT IF(usage_volume_MB_finance_investing > 0, imsi_num, NULL)) AS num_finance_investing_users,
  COUNT(DISTINCT IF(usage_volume_MB_shopping_food > 0, imsi_num, NULL)) AS num_shopping_food_users,
  COUNT(DISTINCT IF(usage_volume_MB_shopping_miscellaneous > 0, imsi_num, NULL)) AS num_shopping_miscellaneous_users,
  COUNT(DISTINCT IF(usage_volume_MB_network_other > 0, imsi_num, NULL)) AS num_network_other_users,
  COUNT(DISTINCT IF(usage_volume_MB_productivity_storage > 0, imsi_num, NULL)) AS num_productivity_storage_users,
  COUNT(DISTINCT IF(usage_volume_MB_travel_smartcar > 0, imsi_num, NULL)) AS num_travel_smartcar_users,

FROM `cto-wln-sa-data-pr-bb5283.customer_personas_features.imsi_app_usage_trends_weekly_ts` 
GROUP BY ts_index, start_dt, end_dt
ORDER BY ts_index